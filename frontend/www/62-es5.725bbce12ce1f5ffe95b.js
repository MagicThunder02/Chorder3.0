!function(){function t(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function n(t,n){for(var i=0;i<n.length;i++){var e=n[i];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}(window.webpackJsonp=window.webpackJsonp||[]).push([[62],{Ugot:function(i,e,o){"use strict";o.r(e),o.d(e,"ChordmakerPageModule",function(){return J});var c=o("ofXK"),r=o("3Pt+"),s=o("TEn/"),b=o("sYmb"),a=o("99Un"),l=o("tk/3"),u=o("HU+/"),f=o("tyNb"),d=o("mrSG"),h=o("dy81"),g=o("XlTo"),p=o("gkyA"),m=o("4WDQ"),x=o("90kD"),v=o("fXoL");function y(t,n){if(1&t){var i=v.Nb();v.Mb(0,"ion-col",6),v.Mb(1,"ion-button",7),v.Ub("click",function(){v.gc(i);var t=n.$implicit;return v.Wb().selectTile(t)}),v.Mb(2,"ion-text",8),v.oc(3),v.Xb(4,"musicNotation"),v.Lb(),v.Lb(),v.Lb()}if(2&t){var e=n.$implicit;v.xb(1),v.bc("color",e.color),v.xb(2),v.qc(" ",v.Yb(4,2,e.name)," ")}}function k(t,n){if(1&t&&(v.Mb(0,"ion-text"),v.oc(1),v.Xb(2,"translate"),v.Xb(3,"musicNotation"),v.Lb()),2&t){var i=n.$implicit;v.xb(1),v.qc(" ",v.Yb(2,1,v.Yb(3,3,i))," ")}}function M(t,n){if(1&t&&(v.Mb(0,"ion-card-subtitle",14),v.mc(1,k,4,5,"ion-text",15),v.Lb()),2&t){var i=v.Wb().$implicit;v.xb(1),v.bc("ngForOf",i.name)}}function I(t,n){if(1&t&&(v.Mb(0,"ion-text"),v.oc(1),v.Xb(2,"translate"),v.Xb(3,"musicNotation"),v.Ib(4,"br"),v.Lb()),2&t){var i=v.Wb(2).$implicit;v.xb(1),v.rc("",v.Yb(2,2,"tonic"),": ",v.Yb(3,4,i.tonic)," ")}}function L(t,n){if(1&t&&(v.Mb(0,"ion-text"),v.oc(1),v.Xb(2,"translate"),v.Xb(3,"musicNotation"),v.Ib(4,"br"),v.Lb()),2&t){var i=v.Wb(2).$implicit;v.xb(1),v.rc("",v.Yb(2,2,"root"),": ",v.Yb(3,4,i.root),"")}}function W(t,n){if(1&t&&(v.Mb(0,"ion-text"),v.oc(1),v.Xb(2,"translate"),v.Ib(3,"br"),v.Lb()),2&t){var i=v.Wb(2).$implicit,e=v.Wb();v.xb(1),v.rc("",v.Yb(2,2,"intervals"),": ",e.beautify(i.intervals,!1)," ")}}function w(t,n){if(1&t&&(v.Mb(0,"ion-text"),v.oc(1),v.Xb(2,"translate"),v.Ib(3,"br"),v.Lb()),2&t){var i=v.Wb(2).$implicit;v.xb(1),v.rc(" ",v.Yb(2,2,"type"),": ",i.type," ")}}function C(t,n){if(1&t&&(v.Mb(0,"ion-text"),v.oc(1),v.Xb(2,"translate"),v.Ib(3,"br"),v.Ib(4,"br"),v.Lb()),2&t){var i=v.Wb(2).$implicit,e=v.Wb();v.xb(1),v.rc(" ",v.Yb(2,2,"aliases"),": ",e.beautify(i.aliases)," ")}}function E(t,n){if(1&t){var i=v.Nb();v.Mb(0,"ion-icon",22),v.Ub("click",function(){return v.gc(i),v.Wb(5).expandExtensions=!0}),v.Lb()}}function $(t,n){if(1&t&&(v.Mb(0,"ion-text",20),v.oc(1),v.Xb(2,"translate"),v.mc(3,E,1,0,"ion-icon",21),v.Ib(4,"br"),v.Lb()),2&t){var i=v.Wb(3).$implicit,e=v.Wb();v.xb(1),v.rc(" ",v.Yb(2,3,"extensions"),": ",e.beautify(i.extensions.slice(0,3))," "),v.xb(2),v.bc("ngIf",i.extensions.length>3)}}function X(t,n){if(1&t&&(v.Kb(0),v.mc(1,$,5,5,"ion-text",19),v.Jb()),2&t){var i=v.Wb(2).$implicit;v.xb(1),v.bc("ngIf",""!=i.extensions)}}function Y(t,n){if(1&t&&(v.Mb(0,"ion-text",20),v.oc(1),v.Xb(2,"translate"),v.Lb()),2&t){var i=v.Wb(3).$implicit,e=v.Wb();v.xb(1),v.rc(" ",v.Yb(2,2,"extensions"),": ",e.beautify(i.extensions)," ")}}function F(t,n){if(1&t){var i=v.Nb();v.Mb(0,"ion-icon",24),v.Ub("click",function(){return v.gc(i),v.Wb(4).expandExtensions=!1}),v.Lb()}}function N(t,n){if(1&t&&(v.Kb(0),v.mc(1,Y,3,4,"ion-text",19),v.mc(2,F,1,0,"ion-icon",23),v.Ib(3,"br"),v.Jb()),2&t){var i=v.Wb(2).$implicit;v.xb(1),v.bc("ngIf",""!=i.extensions),v.xb(1),v.bc("ngIf",i.extensions.length>3)}}function O(t,n){if(1&t){var i=v.Nb();v.Mb(0,"ion-icon",22),v.Ub("click",function(){return v.gc(i),v.Wb(5).expandReduction=!0}),v.Lb()}}function P(t,n){if(1&t&&(v.Mb(0,"ion-text",20),v.oc(1),v.Xb(2,"translate"),v.mc(3,O,1,0,"ion-icon",21),v.Ib(4,"br"),v.Lb()),2&t){var i=v.Wb(3).$implicit,e=v.Wb();v.xb(1),v.rc(" ",v.Yb(2,3,"reductions"),": ",e.beautify(i.reductions.slice(0,3))," "),v.xb(2),v.bc("ngIf",i.reductions.length>3)}}function A(t,n){if(1&t&&(v.Kb(0),v.mc(1,P,5,5,"ion-text",19),v.Jb()),2&t){var i=v.Wb(2).$implicit;v.xb(1),v.bc("ngIf",""!=i.reductions)}}function U(t,n){if(1&t&&(v.Mb(0,"ion-text",20),v.oc(1),v.Xb(2,"translate"),v.Lb()),2&t){var i=v.Wb(3).$implicit,e=v.Wb();v.xb(1),v.rc(" ",v.Yb(2,2,"reductions"),": ",e.beautify(i.reductions)," ")}}function D(t,n){if(1&t){var i=v.Nb();v.Mb(0,"ion-icon",24),v.Ub("click",function(){return v.gc(i),v.Wb(4).expandReduction=!1}),v.Lb()}}function z(t,n){if(1&t&&(v.Kb(0),v.mc(1,U,3,4,"ion-text",19),v.mc(2,D,1,0,"ion-icon",23),v.Jb()),2&t){var i=v.Wb(2).$implicit;v.xb(1),v.bc("ngIf",""!=i.reductions),v.xb(1),v.bc("ngIf",i.reductions.length>3)}}var R=function(){return[]};function T(t,n){if(1&t){var i=v.Nb();v.Mb(0,"ion-card-content",16),v.mc(1,I,5,6,"ion-text",17),v.mc(2,L,5,6,"ion-text",17),v.mc(3,W,4,4,"ion-text",17),v.mc(4,w,4,4,"ion-text",17),v.mc(5,C,5,4,"ion-text",17),v.mc(6,X,2,1,"ng-container",17),v.mc(7,N,4,2,"ng-container",17),v.mc(8,A,2,1,"ng-container",17),v.mc(9,z,3,2,"ng-container",17),v.Ib(10,"br"),v.Mb(11,"ion-button",18),v.Ub("click",function(){v.gc(i);var t=v.Wb().$implicit;return v.Wb().playChord(t,"chord")}),v.oc(12),v.Xb(13,"translate"),v.Lb(),v.Mb(14,"ion-button",18),v.Ub("click",function(){v.gc(i);var t=v.Wb().$implicit;return v.Wb().playChord(t,"arp")}),v.oc(15),v.Xb(16,"translate"),v.Lb(),v.Lb()}if(2&t){var e=v.Wb().$implicit,o=v.Wb();v.xb(1),v.bc("ngIf",e.tonic),v.xb(1),v.bc("ngIf",e.root),v.xb(1),v.bc("ngIf",""!=e.intervals),v.xb(1),v.bc("ngIf",e.type),v.xb(1),v.bc("ngIf",e.aliases!=v.cc(15,R)),v.xb(1),v.bc("ngIf",!o.expandExtensions),v.xb(1),v.bc("ngIf",o.expandExtensions),v.xb(1),v.bc("ngIf",!o.expandReduction),v.xb(1),v.bc("ngIf",o.expandReduction),v.xb(3),v.qc(" ",v.Yb(13,11,"play_chord")," "),v.xb(3),v.qc(" ",v.Yb(16,13,"play_arp")," ")}}function _(t,n){if(1&t){var i=v.Nb();v.Mb(0,"ion-card",9),v.Mb(1,"ion-card-header",10),v.Ub("click",function(){v.gc(i);var t=n.$implicit;return v.Wb().toggleCard(t)}),v.Mb(2,"ion-card-title",11),v.oc(3),v.Xb(4,"musicNotation"),v.Lb(),v.mc(5,M,2,1,"ion-card-subtitle",12),v.Lb(),v.mc(6,T,17,16,"ion-card-content",13),v.Lb()}if(2&t){var e=n.$implicit;v.xb(3),v.pc(v.Yb(4,3,e.symbol)),v.xb(2),v.bc("ngIf",e.show),v.xb(1),v.bc("ngIf",e.show)}}var q,B,G=((B=function(){function i(n,e,o){t(this,i),this.translate=n,this.global=e,this.modalCtrl=o,this.musicNotationPipe=new p.a(this.global),this.translatePipe=new b.c(this.translate,null),this.tiles=[],this.notes=[],this.chords=[],this.expandReduction=!1,this.expandExtensions=!1,this.synth=new g.c({urls:{A2:"pianoA2.wav"},baseUrl:"assets/instruments/"}).toDestination()}var e,o,c;return e=i,(o=[{key:"selectTile",value:function(t){this.chords=[],this.toggleTile(t),this.checkEquals(t),this.colorTiles(),this.findChord()}},{key:"selectInstrument",value:function(){this.synth="",console.log(this.global.instrument),this.synth=new g.c({urls:{A2:this.global.instrument+"A2.wav"},baseUrl:"assets/instruments/"}).toDestination()}},{key:"toggleTile",value:function(t){t.selected=0==t.selected}},{key:"checkEquals",value:function(t){this.tiles.forEach(function(n){var i=h.b.distance(t.name,n.name);"0A"!=i&&"2d"!=i||(n.selected=!1)})}},{key:"colorTiles",value:function(){this.tiles.forEach(function(t){t.color=t.selected?"secondary":"light"})}},{key:"findChord",value:function(){var t=this;this.notes=[],this.tiles.forEach(function(n){n.selected&&t.notes.push(n.name)}),this.notes.length>=3&&(h.a.detect(this.notes).forEach(function(n,i){if(t.chords.push({symbol:n}),!n.includes("/")||1!=n.split("/")[1].length&&2!=n.split("/")[1].length){var e=h.a.get(n);t.chords[i].name=e.name.split(" "),t.chords[i].root=e.root,t.chords[i].intervals=e.intervals,t.chords[i].aliases=e.aliases,t.chords[i].notes=e.notes,t.chords[i].type=e.type,t.chords[i].tonic=e.tonic}else{var o=n.split("/")[0],c=h.a.get(o);t.chords[i].name=(c.name+" slash "+n.split("/")[1]).split(" "),t.chords[i].root=n.split("/")[1],t.chords[i].intervals=c.intervals,t.chords[i].type=c.type+" slashed",t.chords[i].tonic=c.tonic,t.chords[i].notes=c.notes,t.chords[i].notes.push(n.split("/")[1])}t.chords[i].extensions=h.a.extended(n),t.chords[i].reductions=h.a.reduced(n),t.chords.forEach(function(t){t.show=!1})}),console.log(this.chords))}},{key:"toggleCard",value:function(t){t.show=0==t.show}},{key:"playChord",value:function(t,n){var i=this,e=["Cb","C","C#","Db","D","D#","Eb","E","E#","Fb","F","F#","Gb","G","G#","Ab","A","A#","Bb","B","B#"],o=t.notes.map(function(n,i){if(n.includes("##")){var o=e.indexOf(n.slice(0,-1));n=e[(o+2)%e.length]}if(n.includes("bb")){var c=e.indexOf(n);n=e[(c-2)%e.length]}return parseInt(t.intervals[i],10)<=7?n+"3":n+"4"});"arp"==n?o.forEach(function(t,n){i.synth.triggerAttackRelease(t,"4n",g.e()+n/2)}):"chord"==n&&this.synth.triggerAttackRelease(o,"2n")}},{key:"beautify",value:function(t){var n=this,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],e="";switch(i){case!0:if(t)return t.forEach(function(i,o){0!=o&&o!=t.length&&""!=i?e=e+", "+n.musicNotationPipe.transform(i):e+=n.musicNotationPipe.transform(i)}),e;break;case!1:return t.forEach(function(n,i){0!=i&&i!=t.length&&""!=n?e=e+", "+n:e+=n}),e}}},{key:"ionViewDidEnter",value:function(){this.selectInstrument()}},{key:"ngOnInit",value:function(){var t=this;["Cb","C","C#","Db","D","D#","Eb","E","E#","Fb","F","F#","Gb","G","G#","Ab","A","A#","Bb","B","B#"].forEach(function(n,i){t.tiles.push({name:n,color:"light",selected:!1})}),console.log(this.tiles)}},{key:"openModal",value:function(){return Object(d.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.modalCtrl.create({component:x.a,componentProps:{pageName:"chordmaker"},cssClass:"fullscreen"});case 2:return n=t.sent,t.next=5,n.present();case 5:case"end":return t.stop()}},t,this)}))}}])&&n(e.prototype,o),c&&n(e,c),i}()).\u0275fac=function(t){return new(t||B)(v.Hb(b.d),v.Hb(m.a),v.Hb(s.P))},B.\u0275cmp=v.Bb({type:B,selectors:[["app-chordmaker"]],decls:14,vars:5,consts:[["slot","start"],["lines","none"],[2,"padding","0","text-align","left"],["name","information-circle-outline","color","medium","size","large","slot","end",3,"click"],["size","4","class","col-tiles",4,"ngFor","ngForOf"],["style","border: 1px solid grey;",4,"ngFor","ngForOf"],["size","4",1,"col-tiles"],[1,"button-tiles",3,"color","click"],[1,"button-title"],[2,"border","1px solid grey"],[3,"click"],[1,"card-title"],["class","card-subtitle",4,"ngIf"],["class","card-content",4,"ngIf"],[1,"card-subtitle"],[4,"ngFor","ngForOf"],[1,"card-content"],[4,"ngIf"],["color","secondary",3,"click"],["class","center",4,"ngIf"],[1,"center"],["name","ellipsis-horizontal","style","padding-left: 3%;",3,"click",4,"ngIf"],["name","ellipsis-horizontal",2,"padding-left","3%",3,"click"],["name","ellipsis-horizontal",3,"click",4,"ngIf"],["name","ellipsis-horizontal",3,"click"]],template:function(t,n){1&t&&(v.Mb(0,"ion-header"),v.Mb(1,"ion-toolbar"),v.Mb(2,"ion-buttons",0),v.Ib(3,"ion-menu-button"),v.Lb(),v.Mb(4,"ion-item",1),v.Mb(5,"ion-title",2),v.oc(6),v.Xb(7,"translate"),v.Lb(),v.Mb(8,"ion-icon",3),v.Ub("click",function(){return n.openModal()}),v.Lb(),v.Lb(),v.Lb(),v.Lb(),v.Mb(9,"ion-content"),v.Mb(10,"ion-grid"),v.Mb(11,"ion-row"),v.mc(12,y,5,4,"ion-col",4),v.Lb(),v.Lb(),v.mc(13,_,7,5,"ion-card",5),v.Lb()),2&t&&(v.xb(6),v.qc(" ",v.Yb(7,3,"home.chordmaker")," "),v.xb(6),v.bc("ngForOf",n.tiles),v.xb(1),v.bc("ngForOf",n.chords))},directives:[s.q,s.M,s.e,s.y,s.t,s.K,s.r,s.l,s.p,s.E,c.h,s.k,s.d,s.J,s.f,s.h,s.j,c.i,s.i,s.g],pipes:[b.c,p.a],styles:[".col-tiles[_ngcontent-%COMP%]{text-transform:none;height:14%}.button-tiles[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;--border-radius:5px;border-radius:5px;margin:auto;height:100%;border:1px solid grey}.button-title[_ngcontent-%COMP%]{font-size:5vmin;font-weight:400}.card-subtitle[_ngcontent-%COMP%]{font-size:4.5vmin;font-weight:400}.card-content[_ngcontent-%COMP%]{font-size:4vmin;font-weight:400}ion-grid[_ngcontent-%COMP%]{height:70%}ion-row[_ngcontent-%COMP%]{height:100%}"]}),B),J=((q=function n(){t(this,n)}).\u0275mod=v.Fb({type:q}),q.\u0275inj=v.Eb({factory:function(t){return new(t||q)},providers:[s.Q],imports:[[c.b,r.a,s.N,f.i.forChild([{path:"",component:G}]),u.a,b.b.forChild({loader:{provide:b.a,useFactory:a.HttpLoaderFactory,deps:[l.a]}})]]}),q)}}])}();